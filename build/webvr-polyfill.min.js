/**
 * @license
 * webvr-polyfill
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * @license
 * wglu-preserve-state.js
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */

!function(e){function t(r){if(i[r])return i[r].exports;var n=i[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var i={};t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,r){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=15)}([function(e,t,i){var r=(i(8),window.top.Util||{});r.MIN_TIMESTEP=.001,r.MAX_TIMESTEP=1,r.base64=function(e,t){return"data:"+e+";base64,"+t},r.clamp=function(e,t,i){return Math.min(Math.max(t,e),i)},r.lerp=function(e,t,i){return e+(t-e)*i},r.race=function(e){return Promise.race?Promise.race(e):new Promise(function(t,i){for(var r=0;r<e.length;r++)e[r].then(t,i)})},r.isIOS=function(){var e=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return e}}(),r.isWebViewAndroid=function(){var e=-1!==navigator.userAgent.indexOf("Version")&&-1!==navigator.userAgent.indexOf("Android")&&-1!==navigator.userAgent.indexOf("Chrome");return function(){return e}}(),r.isSafari=function(){var e=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return e}}(),r.isFirefoxAndroid=function(){var e=-1!==navigator.userAgent.indexOf("Firefox")&&-1!==navigator.userAgent.indexOf("Android");return function(){return e}}(),r.isLandscapeMode=function(){return 90==window.orientation||-90==window.orientation},r.isTimestampDeltaValid=function(e){return!isNaN(e)&&(!(e<=r.MIN_TIMESTEP)&&!(e>r.MAX_TIMESTEP))},r.getScreenWidth=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},r.getScreenHeight=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},r.requestFullscreen=function(e){if(r.isWebViewAndroid())return!1;if(e.requestFullscreen)e.requestFullscreen();else if(e.webkitRequestFullscreen)e.webkitRequestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else{if(!e.msRequestFullscreen)return!1;e.msRequestFullscreen()}return!0},r.exitFullscreen=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else{if(!document.msExitFullscreen)return!1;document.msExitFullscreen()}return!0},r.getFullscreenElement=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},r.linkProgram=function(e,t,i,r){var n=e.createShader(e.VERTEX_SHADER);e.shaderSource(n,t),e.compileShader(n);var s=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(s,i),e.compileShader(s);var o=e.createProgram();e.attachShader(o,n),e.attachShader(o,s);for(var a in r)e.bindAttribLocation(o,r[a],a);return e.linkProgram(o),e.deleteShader(n),e.deleteShader(s),o},r.getProgramUniforms=function(e,t){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n="",s=0;s<r;s++){n=e.getActiveUniform(t,s).name.replace("[0]",""),i[n]=e.getUniformLocation(t,n)}return i},r.orthoMatrix=function(e,t,i,r,n,s,o){var a=1/(t-i),l=1/(r-n),d=1/(s-o);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*d,e[11]=0,e[12]=(t+i)*a,e[13]=(n+r)*l,e[14]=(o+s)*d,e[15]=1,e},r.copyArray=function(e,t){for(var i=0,r=e.length;i<r;i++)t[i]=e[i]},r.isMobile=function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e},r.extend=function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},r.safariCssSizeWorkaround=function(e){if(r.isIOS()){var t=e.style.width,i=e.style.height;e.style.width=parseInt(t)+1+"px",e.style.height=parseInt(i)+"px",setTimeout(function(){e.style.width=t,e.style.height=i},100)}window.Util=r,window.canvas=e},r.isDebug=function(){return r.getQueryParameter("debug")},r.getQueryParameter=function(e){var e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),t=new RegExp("[\\?&]"+e+"=([^&#]*)"),i=t.exec(location.search);return null===i?"":decodeURIComponent(i[1].replace(/\+/g," "))},r.frameDataFromPose=function(){function e(e,t,i,r){var n=Math.tan(t?t.upDegrees*s:o),a=Math.tan(t?t.downDegrees*s:o),l=Math.tan(t?t.leftDegrees*s:o),d=Math.tan(t?t.rightDegrees*s:o),h=2/(l+d),c=2/(n+a);return e[0]=h,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(l-d)*h*.5,e[9]=(n-a)*c*.5,e[10]=r/(i-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*i/(i-r),e[15]=0,e}function t(e,t,i){var r=t[0],n=t[1],s=t[2],o=t[3],a=r+r,l=n+n,d=s+s,h=r*a,c=r*l,u=r*d,p=n*l,A=n*d,f=s*d,m=o*a,v=o*l,g=o*d;return e[0]=1-(p+f),e[1]=c+g,e[2]=u-v,e[3]=0,e[4]=c-g,e[5]=1-(h+f),e[6]=A+m,e[7]=0,e[8]=u+v,e[9]=A-m,e[10]=1-(h+p),e[11]=0,e[12]=i[0],e[13]=i[1],e[14]=i[2],e[15]=1,e}function i(e,t,i){var r,n,s,o,a,l,d,h,c,u,p,A,f=i[0],m=i[1],v=i[2];return t===e?(e[12]=t[0]*f+t[4]*m+t[8]*v+t[12],e[13]=t[1]*f+t[5]*m+t[9]*v+t[13],e[14]=t[2]*f+t[6]*m+t[10]*v+t[14],e[15]=t[3]*f+t[7]*m+t[11]*v+t[15]):(r=t[0],n=t[1],s=t[2],o=t[3],a=t[4],l=t[5],d=t[6],h=t[7],c=t[8],u=t[9],p=t[10],A=t[11],e[0]=r,e[1]=n,e[2]=s,e[3]=o,e[4]=a,e[5]=l,e[6]=d,e[7]=h,e[8]=c,e[9]=u,e[10]=p,e[11]=A,e[12]=r*f+a*m+c*v+t[12],e[13]=n*f+l*m+u*v+t[13],e[14]=s*f+d*m+p*v+t[14],e[15]=o*f+h*m+A*v+t[15]),e}function r(e,t){var i=t[0],r=t[1],n=t[2],s=t[3],o=t[4],a=t[5],l=t[6],d=t[7],h=t[8],c=t[9],u=t[10],p=t[11],A=t[12],f=t[13],m=t[14],v=t[15],g=i*a-r*o,w=i*l-n*o,y=i*d-s*o,b=r*l-n*a,E=r*d-s*a,_=n*d-s*l,T=h*f-c*A,R=h*m-u*A,D=h*v-p*A,M=c*m-u*f,S=c*v-p*f,C=u*v-p*m,F=g*C-w*S+y*M+b*D-E*R+_*T;return F?(F=1/F,e[0]=(a*C-l*S+d*M)*F,e[1]=(n*S-r*C-s*M)*F,e[2]=(f*_-m*E+v*b)*F,e[3]=(u*E-c*_-p*b)*F,e[4]=(l*D-o*C-d*R)*F,e[5]=(i*C-n*D+s*R)*F,e[6]=(m*y-A*_-v*w)*F,e[7]=(h*_-u*y+p*w)*F,e[8]=(o*S-a*D+d*T)*F,e[9]=(r*D-i*S-s*T)*F,e[10]=(A*E-f*y+v*g)*F,e[11]=(c*y-h*E-p*g)*F,e[12]=(a*R-o*M-l*T)*F,e[13]=(i*M-r*R+n*T)*F,e[14]=(f*w-A*b-m*g)*F,e[15]=(h*b-c*w+u*g)*F,e):null}function n(n,s,o,d,h){e(n,d?d.fieldOfView:null,h.depthNear,h.depthFar),t(s,o.orientation||a,o.position||l),d&&i(s,s,d.offset),r(s,s)}var s=Math.PI/180,o=.25*Math.PI,a=new Float32Array([0,0,0,1]),l=new Float32Array([0,0,0]);return function(e,t,i){return!(!e||!t)&&(e.pose=t,e.timestamp=t.timestamp,n(e.leftProjectionMatrix,e.leftViewMatrix,t,i.getEyeParameters("left"),i),n(e.rightProjectionMatrix,e.rightViewMatrix,t,i.getEyeParameters("right"),i),!0)}}(),r.isInsideCrossDomainIFrame=function(){var e=window.self!==window.top,t=r.getDomainFromUrl(document.referrer),i=r.getDomainFromUrl(window.location.href);return e&&t!==i},r.getDomainFromUrl=function(e){var t;return t=e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0],t=t.split(":")[0]},e.exports=r},function(e,t,i){function r(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null}function n(){this.isPolyfilled=!0,this.displayId=h++,this.displayName="webvr-polyfill displayName",this.depthNear=.01,this.depthFar=1e4,this.isConnected=!0,this.isPresenting=!1,this.capabilities={hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1},this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,this.wakelock_=new d}function s(){this.isPolyfilled=!0,this.hardwareUnitId="webvr-polyfill hardwareUnitId",this.deviceId="webvr-polyfill deviceId",this.deviceName="webvr-polyfill deviceName"}function o(){}function a(){}var l=i(0),d=i(24),h=1e3,c=!1,u=[0,0,.5,1],p=[.5,0,.5,1];n.prototype.getFrameData=function(e){return l.frameDataFromPose(e,this.getPose(),this)},n.prototype.getPose=function(){return this.getImmediatePose()},n.prototype.requestAnimationFrame=function(e){return window.requestAnimationFrame(e)},n.prototype.cancelAnimationFrame=function(e){return window.cancelAnimationFrame(e)},n.prototype.wrapForFullscreen=function(e){if(l.isIOS()||l.isWechat()||l.isTBS())return e;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var t=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",t.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==e)return this.fullscreenWrapper_;this.removeFullscreenWrapper(),this.fullscreenElement_=e;var i=this.fullscreenElement_.parentElement;i.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),i.removeChild(this.fullscreenElement_),this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var r=this;return function(){if(r.fullscreenElement_){var e=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];r.fullscreenElement_.setAttribute("style",e.join("; ")+";")}}(),this.fullscreenWrapper_},n.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var e=this.fullscreenElement_;this.fullscreenElementCachedStyle_?e.setAttribute("style",this.fullscreenElementCachedStyle_):e.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var t=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(e),t.insertBefore(e,this.fullscreenWrapper_),t.removeChild(this.fullscreenWrapper_),e}},n.prototype.requestPresent=function(e){var t=this.isPresenting,i=this;return e instanceof Array||(c||(console.warn("Using a deprecated form of requestPresent. Should pass in an array of VRLayers."),c=!0),e=[e]),new Promise(function(r,n){if(!i.capabilities.canPresent)return void n(new Error("VRDisplay is not capable of presenting."));if(0==e.length||e.length>i.capabilities.maxLayers)return void n(new Error("Invalid number of layers."));var s=e[0];if(!s.source)return l.debug("source is not provided"),void r();var o=s.leftBounds||u,a=s.rightBounds||p;if(t){var d=i.layer_;d.source!==s.source&&(d.source=s.source);for(var h=0;h<4;h++)d.leftBounds[h]=o[h],d.rightBounds[h]=a[h];return void r()}if(i.layer_={predistorted:s.predistorted,source:s.source,leftBounds:o.slice(0),rightBounds:a.slice(0)},l.debug(i.layer_),i.waitingForPresent_=!1,i.layer_&&i.layer_.source){var c=i.wrapForFullscreen(i.layer_.source);l.debug("Get fullscreenElement");var A=function(){var e=l.getFullscreenElement();i.isPresenting=c===e,i.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(e){console.error("screen.orientation.lock() failed due to",e.message)}),i.waitingForPresent_=!1,i.beginPresent_(),r()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),i.removeFullscreenWrapper(),i.wakelock_.release(),i.endPresent_(),i.removeFullscreenListeners_()),i.fireVRDisplayPresentChange_()},f=function(){i.waitingForPresent_&&(i.removeFullscreenWrapper(),i.removeFullscreenListeners_(),i.wakelock_.release(),i.waitingForPresent_=!1,i.isPresenting=!1,n(new Error("Unable to present.")))};i.addFullscreenListeners_(c,A,f),l.debug("addEvent:onFullscreenChange success"),l.isWechat()||l.isTBS()?(i.wakelock_.request(),i.waitingForPresent_=!0):l.isIOS()||l.isWebViewAndroid()?(i.wakelock_.request(),i.isPresenting=!0,i.beginPresent_(),i.fireVRDisplayPresentChange_(),r()):l.requestFullscreen(c)?(i.wakelock_.request(),i.waitingForPresent_=!0):l.isIOS()&&(i.wakelock_.request(),i.isPresenting=!0,i.beginPresent_(),i.fireVRDisplayPresentChange_(),r())}i.waitingForPresent_||l.isIOS()||(l.exitFullscreen(),n(new Error("Unable to present.")))})},n.prototype.exitPresent=function(){var e=this.isPresenting,t=this;return this.isPresenting=!1,this.layer_=null,this.wakelock_.release(),new Promise(function(i,r){e?((!l.exitFullscreen()&&l.isIOS()||l.isWechat||l.isTBS)&&(t.endPresent_(),t.fireVRDisplayPresentChange_()),l.isWebViewAndroid()&&(t.removeFullscreenWrapper(),t.removeFullscreenListeners_(),t.endPresent_(),t.fireVRDisplayPresentChange_()),i()):r(new Error("Was not presenting to VRDisplay."))})},n.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},n.prototype.fireVRDisplayPresentChange_=function(){var e=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(e)},n.prototype.fireVRDisplayConnect_=function(){var e=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(e)},n.prototype.addFullscreenListeners_=function(e,t,i){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=e,this.fullscreenChangeHandler_=t,this.fullscreenErrorHandler_=i,t&&(document.fullscreenEnabled?e.addEventListener("fullscreenchange",t,!1):document.webkitFullscreenEnabled?e.addEventListener("webkitfullscreenchange",t,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",t,!1):document.msFullscreenEnabled&&e.addEventListener("msfullscreenchange",t,!1)),i&&(document.fullscreenEnabled?e.addEventListener("fullscreenerror",i,!1):document.webkitFullscreenEnabled?e.addEventListener("webkitfullscreenerror",i,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",i,!1):document.msFullscreenEnabled&&e.addEventListener("msfullscreenerror",i,!1))},n.prototype.removeFullscreenListeners_=function(){if(this.fullscreenEventTarget_){var e=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var t=this.fullscreenChangeHandler_;e.removeEventListener("fullscreenchange",t,!1),e.removeEventListener("webkitfullscreenchange",t,!1),document.removeEventListener("mozfullscreenchange",t,!1),e.removeEventListener("msfullscreenchange",t,!1)}if(this.fullscreenErrorHandler_){var i=this.fullscreenErrorHandler_;e.removeEventListener("fullscreenerror",i,!1),e.removeEventListener("webkitfullscreenerror",i,!1),document.removeEventListener("mozfullscreenerror",i,!1),e.removeEventListener("msfullscreenerror",i,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},n.prototype.beginPresent_=function(){},n.prototype.endPresent_=function(){},n.prototype.submitFrame=function(e){},n.prototype.getEyeParameters=function(e){return null},o.prototype=new s,a.prototype=new s,e.exports.VRFrameData=r,e.exports.VRDisplay=n,e.exports.VRDevice=s,e.exports.HMDVRDevice=o,e.exports.PositionSensorVRDevice=a},function(e,t){var i=window.MathUtil||{};i.degToRad=Math.PI/180,i.radToDeg=180/Math.PI,i.Vector2=function(e,t){this.x=e||0,this.y=t||0},i.Vector2.prototype={constructor:i.Vector2,set:function(e,t){return this.x=e,this.y=t,this},copy:function(e){return this.x=e.x,this.y=e.y,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}},i.Vector3=function(e,t,i){this.x=e||0,this.y=t||0,this.z=i||0},i.Vector3.prototype={constructor:i.Vector3,set:function(e,t,i){return this.x=e,this.y=t,this.z=i,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var e=this.length();if(0!==e){var t=1/e;this.multiplyScalar(t)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(e){this.x*=e,this.y*=e,this.z*=e},applyQuaternion:function(e){var t=this.x,i=this.y,r=this.z,n=e.x,s=e.y,o=e.z,a=e.w,l=a*t+s*r-o*i,d=a*i+o*t-n*r,h=a*r+n*i-s*t,c=-n*t-s*i-o*r;return this.x=l*a+c*-n+d*-o-h*-s,this.y=d*a+c*-s+h*-n-l*-o,this.z=h*a+c*-o+l*-s-d*-n,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},crossVectors:function(e,t){var i=e.x,r=e.y,n=e.z,s=t.x,o=t.y,a=t.z;return this.x=r*a-n*o,this.y=n*s-i*a,this.z=i*o-r*s,this}},i.Quaternion=function(e,t,i,r){this.x=e||0,this.y=t||0,this.z=i||0,this.w=void 0!==r?r:1},i.Quaternion.prototype={constructor:i.Quaternion,set:function(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},setFromEulerXYZ:function(e,t,i){var r=Math.cos(e/2),n=Math.cos(t/2),s=Math.cos(i/2),o=Math.sin(e/2),a=Math.sin(t/2),l=Math.sin(i/2);return this.x=o*n*s+r*a*l,this.y=r*a*s-o*n*l,this.z=r*n*l+o*a*s,this.w=r*n*s-o*a*l,this},setFromEulerYXZ:function(e,t,i){var r=Math.cos(e/2),n=Math.cos(t/2),s=Math.cos(i/2),o=Math.sin(e/2),a=Math.sin(t/2),l=Math.sin(i/2);return this.x=o*n*s+r*a*l,this.y=r*a*s-o*n*l,this.z=r*n*l-o*a*s,this.w=r*n*s+o*a*l,this},setFromAxisAngle:function(e,t){var i=t/2,r=Math.sin(i);return this.x=e.x*r,this.y=e.y*r,this.z=e.z*r,this.w=Math.cos(i),this},multiply:function(e){return this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var i=e.x,r=e.y,n=e.z,s=e.w,o=t.x,a=t.y,l=t.z,d=t.w;return this.x=i*d+s*o+r*l-n*a,this.y=r*d+s*a+n*o-i*l,this.z=n*d+s*l+i*a-r*o,this.w=s*d-i*o-r*a-n*l,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=1):(e=1/e,this.x=this.x*e,this.y=this.y*e,this.z=this.z*e,this.w=this.w*e),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var i=this.x,r=this.y,n=this.z,s=this.w,o=s*e.w+i*e.x+r*e.y+n*e.z;if(o<0?(this.w=-e.w,this.x=-e.x,this.y=-e.y,this.z=-e.z,o=-o):this.copy(e),o>=1)return this.w=s,this.x=i,this.y=r,this.z=n,this;var a=Math.acos(o),l=Math.sqrt(1-o*o);if(Math.abs(l)<.001)return this.w=.5*(s+this.w),this.x=.5*(i+this.x),this.y=.5*(r+this.y),this.z=.5*(n+this.z),this;var d=Math.sin((1-t)*a)/l,h=Math.sin(t*a)/l;return this.w=s*d+this.w*h,this.x=i*d+this.x*h,this.y=r*d+this.y*h,this.z=n*d+this.z*h,this},setFromUnitVectors:function(){var e,t;return function(r,n){return void 0===e&&(e=new i.Vector3),t=r.dot(n)+1,t<1e-6?(t=0,Math.abs(r.x)>Math.abs(r.z)?e.set(-r.y,r.x,0):e.set(0,-r.z,r.y)):e.crossVectors(r,n),this.x=e.x,this.y=e.y,this.z=e.z,this.w=t,this.normalize(),this}}()},e.exports=i},function(e,t,i){function r(e){this.gl=e,this.attribs={position:0},this.program=n.linkProgram(e,o,a,this.attribs),this.uniforms=n.getProgramUniforms(e,this.program),this.vertexBuffer=e.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}var n=i(0),s=i(4),o=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join("\n"),a=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join("\n"),l=Math.PI/180,d=.3125;r.prototype.destroy=function(){var e=this.gl;this.listener&&e.canvas.removeEventListener("click",this.listener,!1),e.deleteProgram(this.program),e.deleteBuffer(this.vertexBuffer)},r.prototype.listen=function(e,t){var i=this.gl.canvas;this.listener=function(r){var n=i.clientWidth/2;r.clientX>n-42&&r.clientX<n+42&&r.clientY>i.clientHeight-42?e(r):r.clientX<42&&r.clientY<42&&t(r)},i.addEventListener("click",this.listener,!1)},r.prototype.onResize=function(){var e=this.gl,t=this,i=[e.ARRAY_BUFFER_BINDING];s(e,i,function(e){function i(e,t){var i=(90-e)*l,r=Math.cos(i),o=Math.sin(i);n.push(d*r*p+s,d*o*p+p),n.push(t*r*p+s,t*o*p+p)}function r(t,i){n.push(A+t,e.drawingBufferHeight-A-i)}var n=[],s=e.drawingBufferWidth/2,o=Math.max(screen.width,screen.height)*window.devicePixelRatio,a=e.drawingBufferWidth/o,h=a*window.devicePixelRatio,c=4*h/2,u=42*h,p=28*h/2,A=14*h;n.push(s-c,u),n.push(s-c,e.drawingBufferHeight),n.push(s+c,u),n.push(s+c,e.drawingBufferHeight),t.gearOffset=n.length/2;for(var f=0;f<=6;f++){var m=60*f;i(m,1),i(m+12,1),i(m+20,.75),i(m+40,.75),i(m+48,1)}t.gearVertexCount=n.length/2-t.gearOffset,t.arrowOffset=n.length/2;var v=c/Math.sin(45*l);r(0,p),r(p,0),r(p+v,v),r(v,p+v),r(v,p-v),r(0,p),r(p,2*p),r(p+v,2*p-v),r(v,p-v),r(0,p),r(v,p-c),r(28*h,p-c),r(v,p+c),r(28*h,p+c),t.arrowVertexCount=n.length/2-t.arrowOffset,e.bindBuffer(e.ARRAY_BUFFER,t.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW)})},r.prototype.render=function(){var e=this.gl,t=this,i=[e.CULL_FACE,e.DEPTH_TEST,e.BLEND,e.SCISSOR_TEST,e.STENCIL_TEST,e.COLOR_WRITEMASK,e.VIEWPORT,e.CURRENT_PROGRAM,e.ARRAY_BUFFER_BINDING];s(e,i,function(e){e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.BLEND),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.colorMask(!0,!0,!0,!0),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight),t.renderNoState()})},r.prototype.renderNoState=function(){var e=this.gl;e.useProgram(this.program),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.enableVertexAttribArray(this.attribs.position),e.vertexAttribPointer(this.attribs.position,2,e.FLOAT,!1,8,0),e.uniform4f(this.uniforms.color,1,1,1,1),n.orthoMatrix(this.projMat,0,e.drawingBufferWidth,0,e.drawingBufferHeight,.1,1024),e.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.drawArrays(e.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),e.drawArrays(e.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)},e.exports=r},function(e,t){function i(e,t,i){if(!t)return void i(e);for(var r=[],n=null,s=0;s<t.length;++s){var o=t[s];switch(o){case e.TEXTURE_BINDING_2D:case e.TEXTURE_BINDING_CUBE_MAP:var a=t[++s];if(a<e.TEXTURE0||a>e.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),r.push(null,null);break}n||(n=e.getParameter(e.ACTIVE_TEXTURE)),e.activeTexture(a),r.push(e.getParameter(o),null);break;case e.ACTIVE_TEXTURE:n=e.getParameter(e.ACTIVE_TEXTURE),r.push(null);break;default:r.push(e.getParameter(o))}}i(e);for(var s=0;s<t.length;++s){var o=t[s],l=r[s];switch(o){case e.ACTIVE_TEXTURE:break;case e.ARRAY_BUFFER_BINDING:e.bindBuffer(e.ARRAY_BUFFER,l);break;case e.COLOR_CLEAR_VALUE:e.clearColor(l[0],l[1],l[2],l[3]);break;case e.COLOR_WRITEMASK:e.colorMask(l[0],l[1],l[2],l[3]);break;case e.CURRENT_PROGRAM:e.useProgram(l);break;case e.ELEMENT_ARRAY_BUFFER_BINDING:e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,l);break;case e.FRAMEBUFFER_BINDING:e.bindFramebuffer(e.FRAMEBUFFER,l);break;case e.RENDERBUFFER_BINDING:e.bindRenderbuffer(e.RENDERBUFFER,l);break;case e.TEXTURE_BINDING_2D:var a=t[++s];if(a<e.TEXTURE0||a>e.TEXTURE31)break;e.activeTexture(a),e.bindTexture(e.TEXTURE_2D,l);break;case e.TEXTURE_BINDING_CUBE_MAP:var a=t[++s];if(a<e.TEXTURE0||a>e.TEXTURE31)break;e.activeTexture(a),e.bindTexture(e.TEXTURE_CUBE_MAP,l);break;case e.VIEWPORT:e.viewport(l[0],l[1],l[2],l[3]);break;case e.BLEND:case e.CULL_FACE:case e.DEPTH_TEST:case e.SCISSOR_TEST:case e.STENCIL_TEST:l?e.enable(o):e.disable(o);break;default:console.log("No GL restore behavior for 0x"+o.toString(16))}n&&e.activeTexture(n)}}e.exports=i},function(e,t,i){function r(e){this.width=e.width||l.getScreenWidth(),this.height=e.height||l.getScreenHeight(),this.widthMeters=e.widthMeters,this.heightMeters=e.heightMeters,this.bevelMeters=e.bevelMeters}function n(e){this.viewer=c.CardboardV2,this.updateDeviceParams(e),this.distortion=new o(this.viewer.distortionCoefficients)}function s(e){this.id=e.id,this.label=e.label,this.fov=e.fov,this.interLensDistance=e.interLensDistance,this.baselineLensDistance=e.baselineLensDistance,this.screenLensDistance=e.screenLensDistance,this.distortionCoefficients=e.distortionCoefficients,this.inverseCoefficients=e.inverseCoefficients}var o=i(12),a=i(2),l=i(0),d=new r({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),h=new r({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),c={CardboardV1:new s({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new s({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};n.prototype.updateDeviceParams=function(e){this.device=this.determineDevice_(e)||this.device},n.prototype.getDevice=function(){return this.device},n.prototype.setViewer=function(e){this.viewer=e,this.distortion=new o(this.viewer.distortionCoefficients)},n.prototype.determineDevice_=function(e){if(!e)return l.isIOS()?(console.warn("Using fallback iOS device measurements."),h):(console.warn("Using fallback Android device measurements."),d);var t=.0254/e.xdpi,i=.0254/e.ydpi;return new r({widthMeters:t*l.getScreenWidth(),heightMeters:i*l.getScreenHeight(),bevelMeters:.001*e.bevelMm})},n.prototype.getDistortedFieldOfViewLeftEye=function(){var e=this.viewer,t=this.device,i=this.distortion,r=e.screenLensDistance,n=(t.widthMeters-e.interLensDistance)/2,s=e.interLensDistance/2,o=e.baselineLensDistance-t.bevelMeters,l=t.heightMeters-o,d=a.radToDeg*Math.atan(i.distort(n/r)),h=a.radToDeg*Math.atan(i.distort(s/r)),c=a.radToDeg*Math.atan(i.distort(o/r)),u=a.radToDeg*Math.atan(i.distort(l/r));return{leftDegrees:Math.min(d,e.fov),rightDegrees:Math.min(h,e.fov),downDegrees:Math.min(c,e.fov),upDegrees:Math.min(u,e.fov)}},n.prototype.getLeftEyeVisibleTanAngles=function(){var e=this.viewer,t=this.device,i=this.distortion,r=Math.tan(-a.degToRad*e.fov),n=Math.tan(a.degToRad*e.fov),s=Math.tan(a.degToRad*e.fov),o=Math.tan(-a.degToRad*e.fov),l=t.widthMeters/4,d=t.heightMeters/2,h=e.baselineLensDistance-t.bevelMeters-d,c=e.interLensDistance/2-l,u=-h,p=e.screenLensDistance,A=i.distort((c-l)/p),f=i.distort((u+d)/p),m=i.distort((c+l)/p),v=i.distort((u-d)/p),g=new Float32Array(4);return g[0]=Math.max(r,A),g[1]=Math.min(n,f),g[2]=Math.min(s,m),g[3]=Math.max(o,v),g},n.prototype.getLeftEyeNoLensTanAngles=function(){var e=this.viewer,t=this.device,i=this.distortion,r=new Float32Array(4),n=i.distortInverse(Math.tan(-a.degToRad*e.fov)),s=i.distortInverse(Math.tan(a.degToRad*e.fov)),o=i.distortInverse(Math.tan(a.degToRad*e.fov)),l=i.distortInverse(Math.tan(-a.degToRad*e.fov)),d=t.widthMeters/4,h=t.heightMeters/2,c=e.baselineLensDistance-t.bevelMeters-h,u=e.interLensDistance/2-d,p=-c,A=e.screenLensDistance,f=(u-d)/A,m=(p+h)/A,v=(u+d)/A,g=(p-h)/A;return r[0]=Math.max(n,f),r[1]=Math.min(s,m),r[2]=Math.min(o,v),r[3]=Math.max(l,g),r},n.prototype.getLeftEyeVisibleScreenRect=function(e){var t=this.viewer,i=this.device,r=t.screenLensDistance,n=(i.widthMeters-t.interLensDistance)/2,s=t.baselineLensDistance-i.bevelMeters,o=(e[0]*r+n)/i.widthMeters,a=(e[1]*r+s)/i.heightMeters,l=(e[2]*r+n)/i.widthMeters,d=(e[3]*r+s)/i.heightMeters;return{x:o,y:d,width:l-o,height:a-d}},n.prototype.getFieldOfViewLeftEye=function(e){return e?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},n.prototype.getFieldOfViewRightEye=function(e){var t=this.getFieldOfViewLeftEye(e);return{leftDegrees:t.rightDegrees,rightDegrees:t.leftDegrees,upDegrees:t.upDegrees,downDegrees:t.downDegrees}},n.prototype.getUndistortedFieldOfViewLeftEye=function(){var e=this.getUndistortedParams_();return{leftDegrees:a.radToDeg*Math.atan(e.outerDist),rightDegrees:a.radToDeg*Math.atan(e.innerDist),downDegrees:a.radToDeg*Math.atan(e.bottomDist),upDegrees:a.radToDeg*Math.atan(e.topDist)}},n.prototype.getUndistortedViewportLeftEye=function(){var e=this.getUndistortedParams_(),t=this.viewer,i=this.device,r=t.screenLensDistance,n=i.widthMeters/r,s=i.heightMeters/r,o=i.width/n,a=i.height/s,l=Math.round((e.eyePosX-e.outerDist)*o),d=Math.round((e.eyePosY-e.bottomDist)*a);return{x:l,y:d,width:Math.round((e.eyePosX+e.innerDist)*o)-l,height:Math.round((e.eyePosY+e.topDist)*a)-d}},n.prototype.getUndistortedParams_=function(){var e=this.viewer,t=this.device,i=this.distortion,r=e.screenLensDistance,n=e.interLensDistance/2/r,s=t.widthMeters/r,o=t.heightMeters/r,l=s/2-n,d=(e.baselineLensDistance-t.bevelMeters)/r,h=e.fov,c=i.distortInverse(Math.tan(a.degToRad*h)),u=Math.min(l,c),p=Math.min(n,c),A=Math.min(d,c);return{outerDist:u,innerDist:p,topDist:Math.min(o-d,c),bottomDist:A,eyePosX:l,eyePosY:d}},n.Viewers=c,e.exports=n},function(e,t,i){function r(e){this.display=e,this.hardwareUnitId=e.displayId,this.deviceId="webvr-polyfill:HMD:"+e.displayId,this.deviceName=e.displayName+" (HMD)"}function n(e){this.display=e,this.hardwareUnitId=e.displayId,this.deviceId="webvr-polyfill:PositionSensor: "+e.displayId,this.deviceName=e.displayName+" (PositionSensor)"}var s=(i(1).VRDisplay,i(1).HMDVRDevice),o=i(1).PositionSensorVRDevice;r.prototype=new s,r.prototype.getEyeParameters=function(e){var t=this.display.getEyeParameters(e);return{currentFieldOfView:t.fieldOfView,maximumFieldOfView:t.fieldOfView,minimumFieldOfView:t.fieldOfView,recommendedFieldOfView:t.fieldOfView,eyeTranslation:{x:t.offset[0],y:t.offset[1],z:t.offset[2]},renderRect:{x:"right"==e?t.renderWidth:0,y:0,width:t.renderWidth,height:t.renderHeight}}},r.prototype.setFieldOfView=function(e,t,i,r){},n.prototype=new o,n.prototype.getState=function(){var e=this.display.getPose();return{position:e.position?{x:e.position[0],y:e.position[1],z:e.position[2]}:null,orientation:e.orientation?{x:e.orientation[0],y:e.orientation[1],z:e.orientation[2],w:e.orientation[3]}:null,linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},n.prototype.resetState=function(){return this.positionDevice.resetPose()},e.exports.VRDisplayHMDDevice=r,e.exports.VRDisplayPositionSensorDevice=n},function(e,t,i){function r(){this.displays=[],this.devices=[],this.devicesPopulated=!1,this.nativeWebVRAvailable=this.isWebVRAvailable(),this.nativeLegacyWebVRAvailable=this.isDeprecatedWebVRAvailable(),this.nativeGetVRDisplaysFunc=this.nativeWebVRAvailable?navigator.getVRDisplays:null,this.nativeLegacyWebVRAvailable||(this.enablePolyfill(),window.WebVRConfig.ENABLE_DEPRECATED_API&&this.enableDeprecatedPolyfill()),n()}function n(){"VRDisplay"in window&&!("VRFrameData"in window)&&(window.VRFrameData=d,"depthNear"in window.VRDisplay.prototype||(window.VRDisplay.prototype.depthNear=.01),"depthFar"in window.VRDisplay.prototype||(window.VRDisplay.prototype.depthFar=1e4),window.VRDisplay.prototype.getFrameData=function(e){return s.frameDataFromPose(e,this.getPose(),this)})}var s=i(0),o=i(11),a=i(16),l=i(1).VRDisplay,d=i(1).VRFrameData,h=i(1).HMDVRDevice,c=i(1).PositionSensorVRDevice,u=i(6).VRDisplayHMDDevice,p=i(6).VRDisplayPositionSensorDevice,A=i(9).version;r.prototype.isWebVRAvailable=function(){return"getVRDisplays"in navigator},r.prototype.isDeprecatedWebVRAvailable=function(){return"getVRDevices"in navigator||"mozGetVRDevices"in navigator},r.prototype.connectDisplay=function(e){e.fireVRDisplayConnect_(),this.displays.push(e)},r.prototype.populateDevices=function(){if(!this.devicesPopulated){var e=null;this.isCardboardCompatible()&&(e=new o,this.connectDisplay(e),window.WebVRConfig.ENABLE_DEPRECATED_API&&(this.devices.push(new u(e)),this.devices.push(new p(e)))),this.isMobile()||window.WebVRConfig.MOUSE_KEYBOARD_CONTROLS_DISABLED||(e=new a,this.connectDisplay(e),window.WebVRConfig.ENABLE_DEPRECATED_API&&(this.devices.push(new u(e)),this.devices.push(new p(e)))),this.devicesPopulated=!0}},r.prototype.enablePolyfill=function(){if(navigator.getVRDisplays=this.getVRDisplays.bind(this),this.nativeWebVRAvailable&&window.VRFrameData){var e=new window.VRFrameData,t=window.VRDisplay.prototype.getFrameData;window.VRFrameData=d,window.VRDisplay.prototype.getFrameData=function(i){t.call(this,e),i.pose=e.pose,s.copyArray(e.leftProjectionMatrix,i.leftProjectionMatrix),s.copyArray(e.rightProjectionMatrix,i.rightProjectionMatrix),s.copyArray(e.leftViewMatrix,i.leftViewMatrix),s.copyArray(e.rightViewMatrix,i.rightViewMatrix)}}if(window.VRDisplay=l,navigator&&!navigator.vrEnabled){var i=this;Object.defineProperty(navigator,"vrEnabled",{get:function(){return i.isCardboardCompatible()&&(i.isFullScreenAvailable()||s.isIOS())}})}"VRFrameData"in window||(window.VRFrameData=d)},r.prototype.enableDeprecatedPolyfill=function(){navigator.getVRDevices=this.getVRDevices.bind(this),window.HMDVRDevice=h,window.PositionSensorVRDevice=c},r.prototype.getVRDisplays=function(){this.populateDevices();var e=this.displays;if(!this.nativeWebVRAvailable)return Promise.resolve(e);var t,i=this.nativeGetVRDisplaysFunc.call(navigator),r=new Promise(function(e){t=setTimeout(function(){console.warn("Native WebVR implementation detected, but `getVRDisplays()` failed to resolve. Falling back to polyfill."),e([])},window.WebVRConfig.GET_VR_DISPLAYS_TIMEOUT)});return s.race([i,r]).then(function(i){return clearTimeout(t),window.WebVRConfig.ALWAYS_APPEND_POLYFILL_DISPLAY?i.concat(e):i.length>0?i:e})},r.prototype.getVRDevices=function(){console.warn("getVRDevices is deprecated. Please update your code to use getVRDisplays instead.");var e=this;return new Promise(function(t,i){try{if(!e.devicesPopulated){if(e.nativeWebVRAvailable)return navigator.getVRDisplays(function(i){for(var r=0;r<i.length;++r)e.devices.push(new u(i[r])),e.devices.push(new p(i[r]));e.devicesPopulated=!0,t(e.devices)},i);if(e.nativeLegacyWebVRAvailable)return(navigator.getVRDDevices||navigator.mozGetVRDevices)(function(i){for(var r=0;r<i.length;++r)i[r]instanceof h&&e.devices.push(i[r]),i[r]instanceof c&&e.devices.push(i[r]);e.devicesPopulated=!0,t(e.devices)},i)}e.populateDevices(),t(e.devices)}catch(e){i(e)}})},r.prototype.isMobile=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},r.prototype.isCardboardCompatible=function(){return this.isMobile()||window.WebVRConfig.FORCE_ENABLE_VR},r.prototype.isFullScreenAvailable=function(){return document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||!1},r.InstallWebVRSpecShim=n,r.version=A,e.exports.WebVRPolyfill=r},function(e,t,i){"use strict";function r(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
var n=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},i=0;i<10;i++)t["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var i,a,l=r(e),d=1;d<arguments.length;d++){i=Object(arguments[d]);for(var h in i)s.call(i,h)&&(l[h]=i[h]);if(n){a=n(i);for(var c=0;c<a.length;c++)o.call(i,a[c])&&(l[a[c]]=i[a[c]])}}return l}},function(e,t){e.exports={name:"webvr-polyfill",version:"0.9.34",homepage:"https://github.com/googlevr/webvr-polyfill",authors:["Boris Smus <boris@smus.com>","Brandon Jones <tojiro@gmail.com>","Jordan Santell <jordan@jsantell.com>"],description:"Use WebVR today, on mobile or desktop, without requiring a special browser build.",devDependencies:{chai:"^3.5.0",jsdom:"^9.12.0",mocha:"^3.2.0",semver:"^5.3.0",webpack:"^2.6.1","webpack-dev-server":"^2.4.5"},main:"src/node-entry",keywords:["vr","webvr"],license:"Apache-2.0",scripts:{start:"npm run watch",watch:"webpack-dev-server",build:"webpack",test:"mocha"},repository:"googlevr/webvr-polyfill",bugs:{url:"https://github.com/googlevr/webvr-polyfill/issues"}}},function(e,t,i){function r(e){this.gl=e,this.ctxAttribs=e.getContextAttributes(),this.meshWidth=20,this.meshHeight=20,this.bufferScale=window.WebVRConfig.BUFFER_SCALE,this.bufferWidth=e.drawingBufferWidth,this.bufferHeight=e.drawingBufferHeight,this.realBindFramebuffer=e.bindFramebuffer,this.realEnable=e.enable,this.realDisable=e.disable,this.realColorMask=e.colorMask,this.realClearColor=e.clearColor,this.realViewport=e.viewport,s.isIOS()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(e.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(e.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=s.linkProgram(e,a,l,this.attribs),this.uniforms=s.getProgramUniforms(e,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),this.indexCount=0,this.renderTarget=e.createTexture(),this.framebuffer=e.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=e.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=e.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=e.createRenderbuffer()),this.patch(),this.onResize(),window.WebVRConfig.CARDBOARD_UI_DISABLED||(this.cardboardUI=new n(e))}var n=i(3),s=i(0),o=i(4),a=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join("\n"),l=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join("\n");r.prototype.destroy=function(){var e=this.gl;this.unpatch(),e.deleteProgram(this.program),e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.indexBuffer),e.deleteTexture(this.renderTarget),e.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&e.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&e.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&e.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},r.prototype.onResize=function(){var e=this.gl,t=this,i=[e.RENDERBUFFER_BINDING,e.TEXTURE_BINDING_2D,e.TEXTURE0];o(e,i,function(e){t.realBindFramebuffer.call(e,e.FRAMEBUFFER,null),t.scissorTest&&t.realDisable.call(e,e.SCISSOR_TEST),t.realColorMask.call(e,!0,!0,!0,!0),t.realViewport.call(e,0,0,e.drawingBufferWidth,e.drawingBufferHeight),t.realClearColor.call(e,0,0,0,1),e.clear(e.COLOR_BUFFER_BIT),t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.framebuffer),e.bindTexture(e.TEXTURE_2D,t.renderTarget),e.texImage2D(e.TEXTURE_2D,0,t.ctxAttribs.alpha?e.RGBA:e.RGB,t.bufferWidth,t.bufferHeight,0,t.ctxAttribs.alpha?e.RGBA:e.RGB,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.renderTarget,0),t.ctxAttribs.depth&&t.ctxAttribs.stencil?(e.bindRenderbuffer(e.RENDERBUFFER,t.depthStencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.bufferWidth,t.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t.depthStencilBuffer)):t.ctxAttribs.depth?(e.bindRenderbuffer(e.RENDERBUFFER,t.depthBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,t.bufferWidth,t.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t.depthBuffer)):t.ctxAttribs.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,t.stencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.STENCIL_INDEX8,t.bufferWidth,t.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,t.stencilBuffer)),!e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.lastBoundFramebuffer),t.scissorTest&&t.realEnable.call(e,e.SCISSOR_TEST),t.realColorMask.apply(e,t.colorMask),t.realViewport.apply(e,t.viewport),t.realClearColor.apply(e,t.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},r.prototype.patch=function(){if(!this.isPatched){var e=this,t=this.gl.canvas,i=this.gl;s.isIOS()||(t.width=s.getScreenWidth()*this.bufferScale,t.height=s.getScreenHeight()*this.bufferScale,Object.defineProperty(t,"width",{configurable:!0,enumerable:!0,get:function(){return e.bufferWidth},set:function(i){e.bufferWidth=i,e.realCanvasWidth.set.call(t,i),e.onResize()}}),Object.defineProperty(t,"height",{configurable:!0,enumerable:!0,get:function(){return e.bufferHeight},set:function(i){e.bufferHeight=i,e.realCanvasHeight.set.call(t,i),e.onResize()}})),this.lastBoundFramebuffer=i.getParameter(i.FRAMEBUFFER_BINDING),null==this.lastBoundFramebuffer&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(i.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(t,r){e.lastBoundFramebuffer=r||e.framebuffer,e.realBindFramebuffer.call(i,t,e.lastBoundFramebuffer)},this.cullFace=i.getParameter(i.CULL_FACE),this.depthTest=i.getParameter(i.DEPTH_TEST),this.blend=i.getParameter(i.BLEND),this.scissorTest=i.getParameter(i.SCISSOR_TEST),this.stencilTest=i.getParameter(i.STENCIL_TEST),i.enable=function(t){switch(t){case i.CULL_FACE:e.cullFace=!0;break;case i.DEPTH_TEST:e.depthTest=!0;break;case i.BLEND:e.blend=!0;break;case i.SCISSOR_TEST:e.scissorTest=!0;break;case i.STENCIL_TEST:e.stencilTest=!0}e.realEnable.call(i,t)},i.disable=function(t){switch(t){case i.CULL_FACE:e.cullFace=!1;break;case i.DEPTH_TEST:e.depthTest=!1;break;case i.BLEND:e.blend=!1;break;case i.SCISSOR_TEST:e.scissorTest=!1;break;case i.STENCIL_TEST:e.stencilTest=!1}e.realDisable.call(i,t)},this.colorMask=i.getParameter(i.COLOR_WRITEMASK),i.colorMask=function(t,r,n,s){e.colorMask[0]=t,e.colorMask[1]=r,e.colorMask[2]=n,e.colorMask[3]=s,e.realColorMask.call(i,t,r,n,s)},this.clearColor=i.getParameter(i.COLOR_CLEAR_VALUE),i.clearColor=function(t,r,n,s){e.clearColor[0]=t,e.clearColor[1]=r,e.clearColor[2]=n,e.clearColor[3]=s,e.realClearColor.call(i,t,r,n,s)},this.viewport=i.getParameter(i.VIEWPORT),i.viewport=function(t,r,n,s){e.viewport[0]=t,e.viewport[1]=r,e.viewport[2]=n,e.viewport[3]=s,e.realViewport.call(i,t,r,n,s)},this.isPatched=!0,s.safariCssSizeWorkaround(t)}},r.prototype.unpatch=function(){if(this.isPatched){var e=this.gl,t=this.gl.canvas;s.isIOS()||(Object.defineProperty(t,"width",this.realCanvasWidth),Object.defineProperty(t,"height",this.realCanvasHeight)),t.width=this.bufferWidth,t.height=this.bufferHeight,e.bindFramebuffer=this.realBindFramebuffer,e.enable=this.realEnable,e.disable=this.realDisable,e.colorMask=this.realColorMask,e.clearColor=this.realClearColor,e.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&e.bindFramebuffer(e.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){s.safariCssSizeWorkaround(t)},1)}},r.prototype.setTextureBounds=function(e,t){e||(e=[0,0,.5,1]),t||(t=[.5,0,.5,1]),this.viewportOffsetScale[0]=e[0],this.viewportOffsetScale[1]=e[1],this.viewportOffsetScale[2]=e[2],this.viewportOffsetScale[3]=e[3],this.viewportOffsetScale[4]=t[0],this.viewportOffsetScale[5]=t[1],this.viewportOffsetScale[6]=t[2],this.viewportOffsetScale[7]=t[3]},r.prototype.submitFrame=function(){var e=this.gl,t=this,i=[];if(window.WebVRConfig.DIRTY_SUBMIT_FRAME_BINDINGS||i.push(e.CURRENT_PROGRAM,e.ARRAY_BUFFER_BINDING,e.ELEMENT_ARRAY_BUFFER_BINDING,e.TEXTURE_BINDING_2D,e.TEXTURE0),o(e,i,function(e){t.realBindFramebuffer.call(e,e.FRAMEBUFFER,null),t.cullFace&&t.realDisable.call(e,e.CULL_FACE),t.depthTest&&t.realDisable.call(e,e.DEPTH_TEST),t.blend&&t.realDisable.call(e,e.BLEND),t.scissorTest&&t.realDisable.call(e,e.SCISSOR_TEST),t.stencilTest&&t.realDisable.call(e,e.STENCIL_TEST),t.realColorMask.call(e,!0,!0,!0,!0),t.realViewport.call(e,0,0,e.drawingBufferWidth,e.drawingBufferHeight),(t.ctxAttribs.alpha||s.isIOS())&&(t.realClearColor.call(e,0,0,0,1),e.clear(e.COLOR_BUFFER_BIT)),e.useProgram(t.program),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.indexBuffer),e.bindBuffer(e.ARRAY_BUFFER,t.vertexBuffer),e.enableVertexAttribArray(t.attribs.position),e.enableVertexAttribArray(t.attribs.texCoord),e.vertexAttribPointer(t.attribs.position,2,e.FLOAT,!1,20,0),e.vertexAttribPointer(t.attribs.texCoord,3,e.FLOAT,!1,20,8),e.activeTexture(e.TEXTURE0),e.uniform1i(t.uniforms.diffuse,0),e.bindTexture(e.TEXTURE_2D,t.renderTarget),e.uniform4fv(t.uniforms.viewportOffsetScale,t.viewportOffsetScale),e.drawElements(e.TRIANGLES,t.indexCount,e.UNSIGNED_SHORT,0),t.cardboardUI&&t.cardboardUI.renderNoState(),t.realBindFramebuffer.call(t.gl,e.FRAMEBUFFER,t.framebuffer),t.ctxAttribs.preserveDrawingBuffer||(t.realClearColor.call(e,0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)),window.WebVRConfig.DIRTY_SUBMIT_FRAME_BINDINGS||t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.lastBoundFramebuffer),t.cullFace&&t.realEnable.call(e,e.CULL_FACE),t.depthTest&&t.realEnable.call(e,e.DEPTH_TEST),t.blend&&t.realEnable.call(e,e.BLEND),t.scissorTest&&t.realEnable.call(e,e.SCISSOR_TEST),t.stencilTest&&t.realEnable.call(e,e.STENCIL_TEST),t.realColorMask.apply(e,t.colorMask),t.realViewport.apply(e,t.viewport),!t.ctxAttribs.alpha&&t.ctxAttribs.preserveDrawingBuffer||t.realClearColor.apply(e,t.clearColor)}),s.isIOS()&&s.isWechat()){var r=e.canvas;r.width==t.bufferWidth&&r.height==t.bufferHeight||(t.bufferWidth=r.width,t.bufferHeight=r.height,t.onResize())}},r.prototype.updateDeviceInfo=function(e){var t=this.gl,i=this,r=[t.ARRAY_BUFFER_BINDING,t.ELEMENT_ARRAY_BUFFER_BINDING];o(t,r,function(t){var r=i.computeMeshVertices_(i.meshWidth,i.meshHeight,e);if(t.bindBuffer(t.ARRAY_BUFFER,i.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW),!i.indexCount){var n=i.computeMeshIndices_(i.meshWidth,i.meshHeight);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW),i.indexCount=n.length}})},r.prototype.computeMeshVertices_=function(e,t,i){for(var r=new Float32Array(2*e*t*5),n=i.getLeftEyeVisibleTanAngles(),o=i.getLeftEyeNoLensTanAngles(),a=i.getLeftEyeVisibleScreenRect(o),l=0,d=0;d<2;d++){for(var h=0;h<t;h++)for(var c=0;c<e;c++,l++){var u=c/(e-1),p=h/(t-1),A=u,f=p,m=s.lerp(n[0],n[2],u),v=s.lerp(n[3],n[1],p),g=Math.sqrt(m*m+v*v),w=i.distortion.distortInverse(g),y=m*w/g,b=v*w/g;u=(y-o[0])/(o[2]-o[0]),p=(b-o[3])/(o[1]-o[3]);i.device.widthMeters,i.device.heightMeters;u=2*(a.x+u*a.width-.5),p=2*(a.y+p*a.height-.5),r[5*l+0]=u,r[5*l+1]=p,r[5*l+2]=A,r[5*l+3]=f,r[5*l+4]=d}var E=n[2]-n[0];n[0]=-(E+n[0]),n[2]=E-n[2],E=o[2]-o[0],o[0]=-(E+o[0]),o[2]=E-o[2],a.x=1-(a.x+a.width)}return r},r.prototype.computeMeshIndices_=function(e,t){for(var i=new Uint16Array(2*(e-1)*(t-1)*6),r=e/2,n=t/2,s=0,o=0,a=0;a<2;a++)for(var l=0;l<t;l++)for(var d=0;d<e;d++,s++)0!=d&&0!=l&&(d<=r==l<=n?(i[o++]=s,i[o++]=s-e-1,i[o++]=s-e,i[o++]=s-e-1,i[o++]=s,i[o++]=s-1):(i[o++]=s-1,i[o++]=s-e,i[o++]=s,i[o++]=s-e,i[o++]=s-1,i[o++]=s-e-1));return i},r.prototype.getOwnPropertyDescriptor_=function(e,t){var i=Object.getOwnPropertyDescriptor(e,t);return void 0!==i.get&&void 0!==i.set||(i.configurable=!0,i.enumerable=!0,i.get=function(){return this.getAttribute(t)},i.set=function(e){this.setAttribute(t,e)}),i},e.exports=r},function(e,t,i){function r(){this.displayName="Cardboard VRDisplay (webvr-polyfill)",this.capabilities.hasOrientation=!0,this.capabilities.canPresent=!0,this.bufferScale_=window.WebVRConfig.BUFFER_SCALE,this.poseSensor_=new l,this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new a(!0,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new o(this.dpdb_.getDeviceParams()),this.viewerSelector_=new h,this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),window.WebVRConfig.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new d),u.isIOS()&&window.addEventListener("resize",this.onResize_.bind(this))}var n=i(10),s=i(3),o=i(5),a=i(13),l=i(19),d=i(17),h=i(23),c=i(1).VRDisplay,u=i(0),p={LEFT:"left",RIGHT:"right"};r.prototype=new c,r.prototype.getImmediatePose=function(){return{position:this.poseSensor_.getPosition(),orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},r.prototype.resetPose=function(){this.poseSensor_.resetPose()},r.prototype.getEyeParameters=function(e){var t,i=[.5*this.deviceInfo_.viewer.interLensDistance,0,0];if(e==p.LEFT)i[0]*=-1,t=this.deviceInfo_.getFieldOfViewLeftEye();else{if(e!=p.RIGHT)return console.error("Invalid eye provided: %s",e),null;t=this.deviceInfo_.getFieldOfViewRightEye()}return{fieldOfView:t,offset:i,renderWidth:.5*this.deviceInfo_.device.width*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_}},r.prototype.onDeviceParamsUpdated_=function(e){u.isDebug()&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(e),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},r.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},r.prototype.beginPresent_=function(){var e=this.layer_.source.getContext("webgl");e||(e=this.layer_.source.getContext("experimental-webgl")),e||(e=this.layer_.source.getContext("webgl2")),e&&(this.layer_.predistorted?window.WebVRConfig.CARDBOARD_UI_DISABLED||(e.canvas.width=u.getScreenWidth()*this.bufferScale_,e.canvas.height=u.getScreenHeight()*this.bufferScale_,this.cardboardUI_=new s(e)):(this.distorter_=new n(e),this.distorter_.updateDeviceInfo(this.deviceInfo_),this.cardboardUI_=this.distorter_.cardboardUI),this.cardboardUI_&&this.cardboardUI_.listen(function(e){this.viewerSelector_.show(this.layer_.source.parentElement),e.stopPropagation(),e.preventDefault()}.bind(this),function(e){this.exitPresent(),e.stopPropagation(),e.preventDefault()}.bind(this)),this.rotateInstructions_&&(u.isLandscapeMode()&&u.isMobile()?this.rotateInstructions_.showTemporarily(1500,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},r.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},r.prototype.submitFrame=function(e){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var t=this.layer_.source.getContext("webgl").canvas;t.width==this.lastWidth&&t.height==this.lastHeight||this.cardboardUI_.onResize(),this.lastWidth=t.width,this.lastHeight=t.height,this.cardboardUI_.render()}},r.prototype.onOrientationChange_=function(e){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},r.prototype.onResize_=function(e){if(this.layer_){var t=this.layer_.source.getContext("webgl"),i=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0 10px 10px 0","box-sizing: content-box"];t.canvas.setAttribute("style",i.join("; ")+";"),u.safariCssSizeWorkaround(t.canvas)}},r.prototype.onViewerChanged_=function(e){this.deviceInfo_.setViewer(e),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},r.prototype.fireVRDisplayDeviceParamsChange_=function(){var e=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(e)},e.exports=r},function(e,t){function i(e){this.coefficients=e}i.prototype.distortInverse=function(e){for(var t=0,i=1,r=e-this.distort(t);Math.abs(i-t)>1e-4;){var n=e-this.distort(i),s=i-n*((i-t)/(n-r));t=i,i=s,r=n}return i},i.prototype.distort=function(e){for(var t=e*e,i=0,r=0;r<this.coefficients.length;r++)i=t*(i+this.coefficients[r]);return(i+1)*e},e.exports=i},function(e,t,i){function r(e,t){if(this.dpdb=s,this.recalculateDeviceParams_(),e){this.onDeviceParamsUpdated=t;var i=new XMLHttpRequest,r=this;i.open("GET",a,!0),i.addEventListener("load",function(){r.loading=!1,i.status>=200&&i.status<=299?(r.dpdb=JSON.parse(i.response),r.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),i.send()}}function n(e){this.xdpi=e.xdpi,this.ydpi=e.ydpi,this.bevelMm=e.bevelMm}var s=i(14),o=i(0),a="https://dpdb.webvr.rocks/dpdb.json";r.prototype.getDeviceParams=function(){return this.deviceParams},r.prototype.recalculateDeviceParams_=function(){var e=this.calcDeviceParams_();e?(this.deviceParams=e,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},r.prototype.calcDeviceParams_=function(){var e=this.dpdb;if(!e)return console.error("DPDB not available."),null;if(1!=e.format)return console.error("DPDB has unexpected format version."),null;if(!e.devices||!e.devices.length)return console.error("DPDB does not have a devices section."),null;var t=navigator.userAgent||navigator.vendor||window.opera,i=o.getScreenWidth(),r=o.getScreenHeight();if(!e.devices)return console.error("DPDB has no devices section."),null;for(var s=0;s<e.devices.length;s++){var a=e.devices[s];if(a.rules)if("ios"==a.type||"android"==a.type){if(o.isIOS()==("ios"==a.type)){for(var l=!1,d=0;d<a.rules.length;d++){var h=a.rules[d];if(this.matchRule_(h,t,i,r)){l=!0;break}}if(l){var c=a.dpi[0]||a.dpi,u=a.dpi[1]||a.dpi;return new n({xdpi:c,ydpi:u,bevelMm:a.bw})}}}else console.warn("Device["+s+"] has invalid type.");else console.warn("Device["+s+"] has no rules section.")}return console.warn("No DPDB device match."),null},r.prototype.matchRule_=function(e,t,i,r){if(!e.ua&&!e.res)return!1;if(e.ua&&t.indexOf(e.ua)<0)return!1;if(e.res){if(!e.res[0]||!e.res[1])return!1;var n=e.res[0],s=e.res[1];if(Math.min(i,r)!=Math.min(n,s)||Math.max(i,r)!=Math.max(n,s))return!1}return!0},e.exports=r},function(e,t){e.exports={format:1,last_updated:"2017-06-01T22:33:42Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3}]}},function(e,t,i){var r=i(0),n=i(7).WebVRPolyfill;window.WebVRConfig=r.extend({FORCE_ENABLE_VR:!1,K_FILTER:.98,PREDICTION_TIME_S:.04,TOUCH_PANNER_DISABLED:!0,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,MOUSE_KEYBOARD_CONTROLS_DISABLED:!1,DEFER_INITIALIZATION:!1,ENABLE_DEPRECATED_API:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1,ALWAYS_APPEND_POLYFILL_DISPLAY:!1,GET_VR_DISPLAYS_TIMEOUT:1e3},window.WebVRConfig),window.WebVRConfig.DEFER_INITIALIZATION?window.InitializeWebVRPolyfill=function(){new n}:new n,window.WebVRPolyfill=n},function(e,t,i){function r(){this.displayName="Mouse and Keyboard VRDisplay (webvr-polyfill)",this.capabilities.hasOrientation=!0,window.renderParam?(document.querySelector("#"+renderParam.parent).addEventListener("keydown",this.onKeyDown_.bind(this)),document.querySelector("#"+renderParam.parent).addEventListener("mousemove",this.onMouseMove_.bind(this)),document.querySelector("#"+renderParam.parent).addEventListener("mousedown",this.onMouseDown_.bind(this)),document.querySelector("#"+renderParam.parent).addEventListener("mouseup",this.onMouseUp_.bind(this))):(window.addEventListener("keydown",this.onKeyDown_.bind(this)),window.addEventListener("mousemove",this.onMouseMove_.bind(this)),window.addEventListener("mousedown",this.onMouseDown_.bind(this)),window.addEventListener("mouseup",this.onMouseUp_.bind(this))),this.phi_=0,this.theta_=0,this.targetAngle_=null,this.angleAnimation_=null,this.orientation_=new s.Quaternion,this.rotateStart_=new s.Vector2,this.rotateEnd_=new s.Vector2,this.rotateDelta_=new s.Vector2,this.isDragging_=!1,this.orientationOut_=new Float32Array(4)}var n=i(1).VRDisplay,s=i(2),o=i(0);r.prototype=new n,r.prototype.getImmediatePose=function(){return this.orientation_.setFromEulerYXZ(this.phi_,this.theta_,0),this.orientationOut_[0]=this.orientation_.x,this.orientationOut_[1]=this.orientation_.y,this.orientationOut_[2]=this.orientation_.z,this.orientationOut_[3]=this.orientation_.w,{position:null,orientation:this.orientationOut_,linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},r.prototype.onKeyDown_=function(e){38==e.keyCode?this.animatePhi_(this.phi_+.15):39==e.keyCode?this.animateTheta_(this.theta_-.15):40==e.keyCode?this.animatePhi_(this.phi_-.15):37==e.keyCode&&this.animateTheta_(this.theta_+.15)},r.prototype.animateTheta_=function(e){this.animateKeyTransitions_("theta_",e)},r.prototype.animatePhi_=function(e){e=o.clamp(e,-Math.PI/2,Math.PI/2),this.animateKeyTransitions_("phi_",e)},r.prototype.animateKeyTransitions_=function(e,t){this.angleAnimation_&&cancelAnimationFrame(this.angleAnimation_);var i=this[e],r=new Date;this.angleAnimation_=requestAnimationFrame(function n(){var s=new Date-r;if(s>=80)return this[e]=t,void cancelAnimationFrame(this.angleAnimation_);this.angleAnimation_=requestAnimationFrame(n.bind(this));var o=s/80;this[e]=i+(t-i)*o}.bind(this))},r.prototype.onMouseDown_=function(e){this.rotateStart_.set(e.clientX,e.clientY),this.isDragging_=!0},r.prototype.onMouseMove_=function(e){if(this.isDragging_||this.isPointerLocked_()){if(this.isPointerLocked_()){var t=e.movementX||e.mozMovementX||0,i=e.movementY||e.mozMovementY||0;this.rotateEnd_.set(this.rotateStart_.x-t,this.rotateStart_.y-i)}else this.rotateEnd_.set(e.clientX,e.clientY);this.rotateDelta_.subVectors(this.rotateEnd_,this.rotateStart_),this.rotateStart_.copy(this.rotateEnd_),this.phi_+=2*Math.PI*this.rotateDelta_.y/screen.height*.3,this.theta_+=2*Math.PI*this.rotateDelta_.x/screen.width*.5,this.phi_=o.clamp(this.phi_,-Math.PI/2,Math.PI/2)}},r.prototype.onMouseUp_=function(e){this.isDragging_=!1},r.prototype.isPointerLocked_=function(){return void 0!==(document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement)},r.prototype.resetPose=function(){this.phi_=0,this.theta_=0},e.exports=r},function(e,t,i){function r(){this.loadIcon_();var e=document.createElement("div"),t=e.style;t.position="fixed",t.top=0,t.right=0,t.bottom=0,t.left=0,t.backgroundColor="#F5F6EB",t.zIndex=1e6;var i=document.createElement("img");i.src=this.icon;var t=i.style;t.width="60px",e.appendChild(i);var r=document.createElement("div"),t=r.style;t.textAlign="center",t.fontSize="16px",t.lineHeight="24px",t.margin="24px 20%",t.width="60%",t.color="#515151",r.innerHTML="VR",e.appendChild(r),this.overlay=e,this.text=r,this.hide()}var n=i(0);r.prototype.show=function(e){e||this.overlay.parentElement?e&&(this.overlay.parentElement&&this.overlay.parentElement!=e&&this.overlay.parentElement.removeChild(this.overlay),e.appendChild(this.overlay)):document.body.appendChild(this.overlay),this.overlay.style.display="block";var t=this.overlay.querySelector("img"),i=t.style;n.isLandscapeMode()?(i.width="20%",i.marginLeft="40%",i.marginTop="3%"):(i.width="50%",i.marginLeft="25%",i.marginTop="25%")},r.prototype.hide=function(){this.overlay.style.display="none"},r.prototype.showTemporarily=function(e,t){this.show(t),this.timer=setTimeout(this.hide.bind(this),e)},r.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},r.prototype.update=function(){this.disableShowTemporarily(),!n.isLandscapeMode()&&n.isMobile()?this.show():this.hide()},r.prototype.loadIcon_=function(){this.icon="data:image/png;base64,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"},e.exports=r},function(e,t,i){function r(e){this.kFilter=e,this.currentAccelMeasurement=new n,this.currentGyroMeasurement=new n,this.previousGyroMeasurement=new n,o.isIOS()?this.filterQ=new s.Quaternion(-1,0,0,1):this.filterQ=new s.Quaternion(1,0,0,1),this.previousFilterQ=new s.Quaternion,this.previousFilterQ.copy(this.filterQ),this.accelQ=new s.Quaternion,this.isOrientationInitialized=!1,this.estimatedGravity=new s.Vector3,this.measuredGravity=new s.Vector3,this.gyroIntegralQ=new s.Quaternion}var n=i(21),s=i(2),o=i(0);r.prototype.addAccelMeasurement=function(e,t){this.currentAccelMeasurement.set(e,t)},r.prototype.addGyroMeasurement=function(e,t){this.currentGyroMeasurement.set(e,t);var i=t-this.previousGyroMeasurement.timestampS;o.isTimestampDeltaValid(i)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},r.prototype.run_=function(){if(!this.isOrientationInitialized)return this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),void(this.isOrientationInitialized=!0);var e=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,t=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,e);this.gyroIntegralQ.multiply(t),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(t);var i=new s.Quaternion;i.copy(this.filterQ),i.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(i),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var r=new s.Quaternion;r.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),r.inverse(),o.isDebug()&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",s.radToDeg*o.getQuaternionAngle(r),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var n=new s.Quaternion;n.copy(this.filterQ),n.multiply(r),this.filterQ.slerp(n,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},r.prototype.getOrientation=function(){return this.filterQ},r.prototype.accelToQuaternion_=function(e){var t=new s.Vector3;t.copy(e),t.normalize();var i=new s.Quaternion;return i.setFromUnitVectors(new s.Vector3(0,0,-1),t),i.inverse(),i},r.prototype.gyroToQuaternionDelta_=function(e,t){var i=new s.Quaternion,r=new s.Vector3;return r.copy(e),r.normalize(),i.setFromAxisAngle(r,e.length()*t),i},e.exports=r},function(e,t,i){function r(){this.deviceId="webvr-polyfill:fused",this.deviceName="VR Position Device (webvr-polyfill:fused)",this.accelerometer=new a.Vector3,this.gyroscope=new a.Vector3,this.start(),this.filter=new n(window.WebVRConfig.K_FILTER),this.posePredictor=new s(window.WebVRConfig.PREDICTION_TIME_S),this.touchPanner=new o,this.filterToWorldQ=new a.Quaternion,l.isIOS()?this.filterToWorldQ.setFromAxisAngle(new a.Vector3(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new a.Vector3(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new a.Quaternion,this.worldToScreenQ=new a.Quaternion,this.originalPoseAdjustQ=new a.Quaternion,this.originalPoseAdjustQ.setFromAxisAngle(new a.Vector3(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),l.isLandscapeMode()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new a.Quaternion,this.isFirefoxAndroid=l.isFirefoxAndroid(),this.isIOS=l.isIOS(),this.deviceMotion=!0,this.orientationOut_=new Float32Array(4)}var n=i(18),s=i(20),o=i(22),a=i(2),l=i(0);r.prototype.getPosition=function(){return null},r.prototype.setDeviceMotion=function(e){this.deviceMotion=e,this.touchPanner.touchMotion=e},r.prototype.getOrientation=function(){var e=this.filter.getOrientation();this.predictedQ=this.posePredictor.getPrediction(e,this.gyroscope,this.previousTimestampS);var t=new a.Quaternion;return t.copy(this.filterToWorldQ),t.multiply(this.resetQ),window.WebVRConfig.TOUCH_PANNER_DISABLED||t.multiply(this.touchPanner.getOrientation()),t.multiply(this.predictedQ),t.multiply(this.worldToScreenQ),window.WebVRConfig.YAW_ONLY&&(t.x=0,t.z=0,t.normalize()),this.orientationOut_[0]=t.x,this.orientationOut_[1]=t.y,this.orientationOut_[2]=t.z,this.orientationOut_[3]=t.w,this.orientationOut_},r.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),l.isLandscapeMode()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ),window.WebVRConfig.TOUCH_PANNER_DISABLED||this.touchPanner.resetSensor()},r.prototype.onDeviceMotion_=function(e){!0===this.deviceMotion&&this.updateDeviceMotion_(e)},r.prototype.updateDeviceMotion_=function(e){var t=e.accelerationIncludingGravity,i=e.rotationRate,r=e.timeStamp/1e3;this.isFirefoxAndroid&&(r/=1e3);var n=r-this.previousTimestampS;if(n<=l.MIN_TIMESTEP||n>l.MAX_TIMESTEP)return console.warn("Invalid timestamps detected. Time step between successive gyroscope sensor samples is very small or not monotonic"),void(this.previousTimestampS=r);this.accelerometer.set(-t.x,-t.y,-t.z),this.gyroscope.set(i.alpha,i.beta,i.gamma),(this.isIOS||this.isFirefoxAndroid)&&this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addAccelMeasurement(this.accelerometer,r),this.filter.addGyroMeasurement(this.gyroscope,r),this.previousTimestampS=r},r.prototype.onOrientationChange_=function(e){this.setScreenTransform_()},r.prototype.onMessage_=function(e){var t=e.data;if(t&&t.type){"devicemotion"===t.type.toLowerCase()&&this.updateDeviceMotion_(t.deviceMotionEvent)}},r.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new a.Vector3(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new a.Vector3(0,0,1),Math.PI/2)}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},r.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),l.isIOS()&&l.isInsideCrossDomainIFrame()&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},r.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)},e.exports=r},function(e,t,i){function r(e){this.predictionTimeS=e,this.previousQ=new n.Quaternion,this.previousTimestampS=null,this.deltaQ=new n.Quaternion,this.outQ=new n.Quaternion}var n=i(2),s=i(0);r.prototype.getPrediction=function(e,t,i){if(!this.previousTimestampS)return this.previousQ.copy(e),this.previousTimestampS=i,e;var r=new n.Vector3;r.copy(t),r.normalize();var o=t.length();if(o<20*n.degToRad)return s.isDebug()&&console.log("Moving slowly, at %s deg/s: no prediction",(n.radToDeg*o).toFixed(1)),this.outQ.copy(e),this.previousQ.copy(e),this.outQ;var a=(this.previousTimestampS,o*this.predictionTimeS);return this.deltaQ.setFromAxisAngle(r,a),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(e),this.previousTimestampS=i,this.outQ},e.exports=r},function(e,t){function i(e,t){this.set(e,t)}i.prototype.set=function(e,t){this.sample=e,this.timestampS=t},i.prototype.copy=function(e){this.set(e.sample,e.timestampS)},e.exports=i},function(e,t,i){function r(){window.renderParam?(document.querySelector("#"+renderParam.parent).addEventListener("touchstart",this.onTouchStart_.bind(this)),document.querySelector("#"+renderParam.parent).addEventListener("touchmove",this.onTouchMove_.bind(this)),document.querySelector("#"+renderParam.parent).addEventListener("touchend",this.onTouchEnd_.bind(this))):(window.addEventListener("touchstart",this.onTouchStart_.bind(this)),window.addEventListener("touchmove",this.onTouchMove_.bind(this)),window.addEventListener("touchend",this.onTouchEnd_.bind(this))),this.isTouching=!1,this.rotateStart=new n.Vector2,this.rotateEnd=new n.Vector2,this.rotateDelta=new n.Vector2,this.theta=0,this.orientation=new n.Quaternion}var n=i(2),s=i(0);r.prototype.getOrientation=function(){return this.orientation.setFromEulerXYZ(0,0,this.theta),this.orientation},r.prototype.resetSensor=function(){this.theta=0},r.prototype.onTouchStart_=function(e){e.touches&&1==e.touches.length&&(this.rotateStart.set(e.touches[0].pageX,e.touches[0].pageY),this.isTouching=!0)},r.prototype.onTouchMove_=function(e){if(e.preventDefault(),this.isTouching){this.rotateEnd.set(e.touches[0].pageX,e.touches[0].pageY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd),s.isIOS()&&(this.rotateDelta.x*=-1);var t=document.body;this.theta+=2*Math.PI*this.rotateDelta.x/t.clientWidth*.5}},r.prototype.onTouchEnd_=function(e){this.isTouching=!1},e.exports=r},function(e,t,i){function r(){try{this.selectedKey=localStorage.getItem(o)}catch(e){console.error("Failed to load viewer profile: %s",e)}this.selectedKey||(this.selectedKey=s),this.dialog=this.createDialog_(n.Viewers),this.root=null,this.onChangeCallbacks_=[]}var n=i(5),s=(i(0),"CardboardV1"),o="WEBVR_CARDBOARD_VIEWER";r.prototype.show=function(e){this.root=e,e.appendChild(this.dialog),this.dialog.querySelector("#"+this.selectedKey).checked=!0,this.dialog.style.display="block"},r.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},r.prototype.getCurrentViewer=function(){return n.Viewers[this.selectedKey]},r.prototype.getSelectedKey_=function(){var e=this.dialog.querySelector("input[name=field]:checked");return e?e.id:null},r.prototype.onChange=function(e){this.onChangeCallbacks_.push(e)},r.prototype.fireOnChange_=function(e){for(var t=0;t<this.onChangeCallbacks_.length;t++)this.onChangeCallbacks_[t](e)},r.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),!this.selectedKey||!n.Viewers[this.selectedKey])return void console.error("ViewerSelector.onSave_: this should never happen!");this.fireOnChange_(n.Viewers[this.selectedKey]);try{localStorage.setItem(o,this.selectedKey)}catch(e){console.error("Failed to save viewer profile: %s",e)}this.hide()},r.prototype.createDialog_=function(e){var t=document.createElement("div");t.classList.add("webvr-polyfill-viewer-selector"),t.style.display="none";var i=document.createElement("div"),r=i.style;r.position="fixed",r.left=0,r.top=0,r.width="100%",r.height="100%",r.background="rgba(0, 0, 0, 0.3)",i.addEventListener("click",this.hide.bind(this));var n=document.createElement("div"),r=n.style;r.boxSizing="border-box",r.position="fixed",r.top="24px",r.left="50%",r.marginLeft="-140px",r.width="280px",r.padding="24px",r.overflow="hidden",r.background="#fafafa",r.fontFamily="'Roboto', sans-serif",r.boxShadow="0px 5px 20px #666",n.appendChild(this.createH1_("Select your viewer"));for(var s in e)n.appendChild(this.createChoice_(s,e[s].label));return n.appendChild(this.createButton_("Save",this.onSave_.bind(this))),t.appendChild(i),t.appendChild(n),t},r.prototype.createH1_=function(e){var t=document.createElement("h1"),i=t.style;return i.color="black",i.fontSize="20px",i.fontWeight="bold",i.marginTop=0,i.marginBottom="24px",t.innerHTML=e,t},r.prototype.createChoice_=function(e,t){var i=document.createElement("div");i.style.marginTop="8px",i.style.color="black";var r=document.createElement("input");r.style.fontSize="30px",r.setAttribute("id",e),r.setAttribute("type","radio"),r.setAttribute("value",e),r.setAttribute("name","field");var n=document.createElement("label");return n.style.marginLeft="4px",n.setAttribute("for",e),n.innerHTML=t,i.appendChild(r),i.appendChild(n),i},r.prototype.createButton_=function(e,t){var i=document.createElement("button");i.innerHTML=e;var r=i.style;return r.float="right",r.textTransform="uppercase",r.color="#1094f7",r.fontSize="14px",r.letterSpacing=0,r.border=0,r.background="none",r.marginTop="16px",i.addEventListener("click",t),i},e.exports=r},function(e,t,i){function r(){function e(e,t,i){var r=document.createElement("source");r.src=i,r.type="video/"+t,e.appendChild(r)}var t=document.createElement("video");t.setAttribute("loop",""),e(t,"webm",s.base64("video/webm","GkXfo0AgQoaBAUL3gQFC8oEEQvOBCEKCQAR3ZWJtQoeBAkKFgQIYU4BnQI0VSalmQCgq17FAAw9CQE2AQAZ3aGFtbXlXQUAGd2hhbW15RIlACECPQAAAAAAAFlSua0AxrkAu14EBY8WBAZyBACK1nEADdW5khkAFVl9WUDglhohAA1ZQOIOBAeBABrCBCLqBCB9DtnVAIueBAKNAHIEAAIAwAQCdASoIAAgAAUAmJaQAA3AA/vz0AAA=")),e(t,"mp4",s.base64("video/mp4","AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAAG21kYXQAAAGzABAHAAABthADAowdbb9/AAAC6W1vb3YAAABsbXZoZAAAAAB8JbCAfCWwgAAAA+gAAAAAAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIVdHJhawAAAFx0a2hkAAAAD3wlsIB8JbCAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAIAAAACAAAAAABsW1kaWEAAAAgbWRoZAAAAAB8JbCAfCWwgAAAA+gAAAAAVcQAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAAAVxtaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAEcc3RibAAAALhzdHNkAAAAAAAAAAEAAACobXA0dgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAIAAgASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAAFJlc2RzAAAAAANEAAEABDwgEQAAAAADDUAAAAAABS0AAAGwAQAAAbWJEwAAAQAAAAEgAMSNiB9FAEQBFGMAAAGyTGF2YzUyLjg3LjQGAQIAAAAYc3R0cwAAAAAAAAABAAAAAQAAAAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAEAAAABAAAAFHN0c3oAAAAAAAAAEwAAAAEAAAAUc3RjbwAAAAAAAAABAAAALAAAAGB1ZHRhAAAAWG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAK2lsc3QAAAAjqXRvbwAAABtkYXRhAAAAAQAAAABMYXZmNTIuNzguMw==")),this.request=function(){t.paused&&t.play()},this.release=function(){t.pause()}}function n(){var e=null;this.request=function(){e||(e=setInterval(function(){window.location=window.location,setTimeout(window.stop,0)},3e4))},this.release=function(){e&&(clearInterval(e),e=null)}}var s=i(0);e.exports=function(){var e=navigator.userAgent||navigator.vendor||window.opera;return e.match(/iPhone/i)||e.match(/iPod/i)?n:r}()}]);
//# sourceMappingURL=webvr-polyfill.min.js.map